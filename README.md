# Тест задержки нажатия для Android

Приложение для точного измерения времени задержки между нажатием на экран и фактическим отображением результата на Android-устройствах.

## Описание

Это приложение позволяет измерить фактическое время отклика системы Android на нажатия пользователя. Приложение использует высокоточные таймеры, учитывает частоту обновления экрана и частоту опроса сенсорного экрана для максимально точного измерения полной задержки между физическим нажатием и отрисовкой интерфейса.

## Функциональность

- Измерение полной задержки между нажатием и отображением результата на экране в миллисекундах
- Учет всех компонентов задержки:
  - Сенсорный отклик (время регистрации касания сенсором)
  - Ожидание vsync (время до начала нового кадра)
  - Обработка системой (Android OS и драйверы)
  - Рендеринг (формирование нового кадра)
  - Физическое обновление экрана (время обновления пикселей)
- Учет характеристик устройства:
  - Частота обновления экрана
  - Приблизительная частота опроса сенсора
- Оценка производительности устройства на основе полученных результатов
- Ведение статистики по всем тестам
- Возможность сброса результатов

## Технические детали

Приложение использует:
- `SystemClock.elapsedRealtimeNanos()` для максимальной точности измерения времени
- Android Choreographer для синхронизации с циклом отрисовки кадров
- Последовательность нескольких фреймов для отслеживания всего пути события касания
- Оценку времени отклика сенсорного экрана на основе типичных характеристик устройств
- Коррекцию результатов с учетом времени одного кадра
- Jetpack Compose для создания современного пользовательского интерфейса
- Поддержка новейших версий Android (минимальная версия SDK 24, целевая версия SDK 35)

## Компоненты задержки

Приложение измеряет и отображает следующие компоненты общей задержки:

1. **Сенсорный отклик (Touch Detection)** - время между физическим нажатием на экран и регистрацией этого нажатия операционной системой. Зависит от частоты опроса сенсорного экрана (обычно 60-240 Гц).

2. **Ожидание vsync (Vsync Wait)** - время ожидания до следующего сигнала вертикальной синхронизации (vsync). Это системный механизм, который определяет момент начала отрисовки нового кадра.

3. **Обработка системой (OS Processing)** - время, затрачиваемое операционной системой Android и драйверами на обработку события касания и подготовку к отрисовке интерфейса.

4. **Рендеринг (Rendering)** - время, затрачиваемое на фактическое формирование нового кадра, включая расчет измененных элементов интерфейса.

5. **Обновление экрана (Display Refresh)** - время, необходимое для физического обновления пикселей на экране устройства.

Общая задержка представляет собой сумму всех этих компонентов с небольшой коррекцией для учета особенностей дисплея.

## Как работает измерение

1. При нажатии на экран записывается начальное время с точностью до наносекунд
2. Добавляется приблизительная оценка времени сенсорного отклика
3. Измеряется время ожидания до следующего vsync события
4. Для трех последовательных кадров измеряются:
   - время обработки системой
   - время рендеринга
   - время обновления экрана
5. Все компоненты суммируются и применяется коррекция с учетом частоты обновления дисплея

## Интерпретация результатов

Результат измерения задержки можно интерпретировать следующим образом:

- **< 20 мс**: Отличная задержка (уровень игровых устройств)
- **20-33 мс**: Очень хорошая задержка (ниже времени кадра на 60 Гц дисплее)
- **33-50 мс**: Хорошая задержка (типично для устройств среднего класса)
- **50-70 мс**: Средняя задержка (заметная, но не критичная)
- **70-100 мс**: Ниже среднего (значительная задержка)
- **> 100 мс**: Высокая задержка (может мешать нормальному взаимодействию)

### Важные замечания:

1. **Минимальная теоретическая задержка** на устройстве с дисплеем 60 Гц составляет около 16.7 мс (время одного кадра) плюс время сенсорного отклика. Таким образом, значения от 20 до 30 мс являются очень хорошими для мобильных устройств.

2. **Частота обновления дисплея** значительно влияет на минимально возможную задержку:
   - 60 Гц: минимум ~16.7 мс
   - 90 Гц: минимум ~11.1 мс
   - 120 Гц: минимум ~8.3 мс

3. **Частота опроса сенсора** также важна для общей задержки:
   - 60 Гц сенсор: ~8-16 мс задержки
   - 120 Гц сенсор: ~4-8 мс задержки
   - 240 Гц сенсор: ~2-4 мс задержки

4. **Сравнительные показатели по устройствам**:
   - Высокопроизводительные игровые устройства: 15-30 мс
   - Флагманские телефоны: 20-40 мс
   - Устройства среднего класса: 30-60 мс
   - Бюджетные устройства: 50-100 мс и выше

## Как использовать

1. Запустите приложение на устройстве
2. Нажмите на большую кнопку в центре экрана
3. После нажатия система измерит все компоненты задержки
4. Просмотрите детализированный результат в разделе "Детализация задержки"
5. Ознакомьтесь с общей оценкой производительности 
6. Повторите несколько раз для получения более точных средних значений
7. При необходимости нажмите "Сбросить статистику" для новой серии тестов

## Совместимость

Приложение совместимо с Android 7.0 (API уровень 24) и выше. 